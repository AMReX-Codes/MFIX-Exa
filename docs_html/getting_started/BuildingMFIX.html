<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Building MFIX-Exa &mdash; MFIX-Exa  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="First Simulation" href="FirstSimulation.html" />
    <link rel="prev" title="Getting Started" href="../GettingStarted_Chapter.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            MFIX-Exa
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../GettingStarted_Chapter.html">Getting Started</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Building MFIX-Exa</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#building-with-gmake">Building with gmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-with-cmake">Building with cmake</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#superbuild-instructions-recommended">SUPERBUILD Instructions (recommended)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#standalone-instructions">STANDALONE instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#few-more-notes-on-building-mfix-exa-with-cmake">Few more notes on building MFIX-Exa with cmake</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="FirstSimulation.html">Running your first simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Visualization.html">Visualizing simulation results</a></li>
<li class="toctree-l2"><a class="reference internal" href="Hpc.html">HPC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Inputs_Chapter.html">Run-time Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ManagingGridHierarchy_Chapter.html">Gridding and Load Balancing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Fluids_Chapter.html">Solving the Fluid Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Particles_Chapter.html">Particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../EB_Chapter.html">Embedded Boundaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Debugging.html">Debugging</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tests and Benchmarks:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../RunningTestSuite.html">Running the MFIX-Exa Test Suite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../RegressionTesting.html">Regression testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CITests.html">Continuous Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NightlyTests.html">Nightly Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../qb/index.html">Qualitative Benchmarks</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MFIX-Exa</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../GettingStarted_Chapter.html">Getting Started</a></li>
      <li class="breadcrumb-item active">Building MFIX-Exa</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/getting_started/BuildingMFIX.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="building-mfix-exa">
<h1>Building MFIX-Exa<a class="headerlink" href="#building-mfix-exa" title="Link to this heading"></a></h1>
<p>This page gives the generic instructions for building MFIX-Exa using gmake and cmake.
For HPC cluser specific instructions, please refer to <a class="reference internal" href="Hpc.html#gettingstarted-hpc"><span class="std std-ref">Building on HPC Sytems</span></a>.</p>
<section id="building-with-gmake">
<h2>Building with gmake<a class="headerlink" href="#building-with-gmake" title="Link to this heading"></a></h2>
<p>If you want to use gmake to build MFIX_Exa, you will need to
clone amrex and AMReX-Hydro into a local directories, and also
clone mfix:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/AMReX-Codes/amrex.git
&gt;<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/AMReX-Codes/AMReX-Hydro.git
&gt;<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>http://mfix.netl.doe.gov/gitlab/exa/mfix.git
&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>mfix/exec
</pre></div>
</div>
<p>Then, edit the GNUmakefile (or set an environment variable)
to define AMREX_HOME and AMREX_HYDRO_HOME
to be the path to the directories where you have put amrex
and AMReX-Hydro.  Note that the default locations of
AMREX_HOME and AMREX_HYDRO_HOME are in the subprojects directory,
which is where a cmake configuration may clone these repositories.
Other options that you can set include</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Possible values</p></th>
<th class="head"><p>Default
value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>COMP</p></td>
<td><p>Compiler (gnu or intel)</p></td>
<td><p>gnu / intel</p></td>
<td><p>gnu</p></td>
</tr>
<tr class="row-odd"><td><p>USE_MPI</p></td>
<td><p>Enable MPI</p></td>
<td><p>TRUE / FALSE</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-even"><td><p>USE_OMP</p></td>
<td><p>Enable OpenMP</p></td>
<td><p>TRUE / FALSE</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-odd"><td><p>USE_CSG</p></td>
<td><p>Enable CSG geometry file support</p></td>
<td><p>TRUE / FALSE</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-even"><td><p>USE_CUDA</p></td>
<td><p>Enable CUDA GPU support</p></td>
<td><p>TRUE / FALSE</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-odd"><td><p>USE_HIP</p></td>
<td><p>Enable HIP GPU support</p></td>
<td><p>TRUE / FALSE</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-even"><td><p>USE_DPCPP</p></td>
<td><p>Enable DPCPP GPU support</p></td>
<td><p>TRUE / FALSE</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-odd"><td><p>USE_HYPRE</p></td>
<td><p>Enable HYPRE support</p></td>
<td><p>TRUE / FALSE</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-even"><td><p>DEBUG</p></td>
<td><p>Create a DEBUG executable</p></td>
<td><p>TRUE / FALSE</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-odd"><td><p>PROFILE</p></td>
<td><p>Include profiling info</p></td>
<td><p>TRUE / FALSE</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-even"><td><p>TRACE_PROFILE</p></td>
<td><p>Include trace profiling info</p></td>
<td><p>TRUE / FALSE</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-odd"><td><p>COMM_PROFILE</p></td>
<td><p>Include comm profiling info</p></td>
<td><p>TRUE / FALSE</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-even"><td><p>TINY_PROFILE</p></td>
<td><p>Include tiny profiling info</p></td>
<td><p>TRUE / FALSE</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-odd"><td><p>DIM</p></td>
<td><p>Dimensionality of problem</p></td>
<td><p>2 / 3</p></td>
<td><p>3</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Do not set both USE_OMP and USE_CUDA/HIP/DPCPP to true.</strong></p>
</div>
<p>Then type</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span>make<span class="w"> </span>-j
</pre></div>
</div>
<p>An executable will appear; the executable name will reflect
some of the build options above.</p>
</section>
<section id="building-with-cmake">
<h2>Building with cmake<a class="headerlink" href="#building-with-cmake" title="Link to this heading"></a></h2>
<p>CMake build is a two-step process. First <code class="docutils literal notranslate"><span class="pre">cmake</span></code> is invoked to create
configuration files and makefiles in a chosen directory (<code class="docutils literal notranslate"><span class="pre">builddir</span></code>).
Next, the actual build is performed by invoking <code class="docutils literal notranslate"><span class="pre">make</span></code> from within <code class="docutils literal notranslate"><span class="pre">builddir</span></code>.
If you are new to CMake, <a class="reference external" href="https://hsf-training.github.io/hsf-training-cmake-webpage/">this short tutorial</a>
from the HEP Software foundation is the perfect place to get started with it.</p>
<p>The CMake build process for MFIX-Exa is summarized as follows:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt; mkdir /path/to/builddir</span>
<span class="go">&gt;&gt; cd    /path/to/builddir</span>
<span class="go">&gt;&gt; cmake [options] -DCMAKE_BUILD_TYPE=[Debug|Release|RelWithDebInfo|MinSizeRel] /path/to/mfix</span>
<span class="go">&gt;&gt; make</span>
</pre></div>
</div>
<p>In the above snippet, <code class="docutils literal notranslate"><span class="pre">[options]</span></code> indicates one or more options for the
customization of the build, as described later in this section.
If the option <code class="docutils literal notranslate"><span class="pre">CMAKE_BUILD_TYPE</span></code> is omitted,
<code class="docutils literal notranslate"><span class="pre">CMAKE_BUILD_TYPE=Release</span></code> is assumed.</p>
<p>There are two modes to build MFIX-Exa with cmake:</p>
<p>o <strong>SUPERBUILD (recommended):</strong> The AMReX and AMReX-Hydro git repos are cloned and built as part
of the MFIX-Exa build process and placed in the <code class="docutils literal notranslate"><span class="pre">mfix/subprojects</span></code> directory.
Each of these repos can be manipulated like a regular git repo
(you can change branches, hashes, add remotes, etc.)
This method is strongly encouraged as it ensures that the configuration options
for MFIX-Exa are compatible with the AMReX and AMReX-Hydro hashes that are checked out.</p>
<p>o <strong>STANDALONE:</strong> MFIX-Exa source code is built separately and linked to existing
AMReX and AMReX-Hydro repos. This is ideal for continuous integration severs (CI)
and regression testing applications. AMReX and AMReX_Hydro library versions and
configuration options must meet MFIX-Exa requirements.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>MFIX-Exa requires CMake 3.20 or higher.</strong></p>
</div>
<section id="superbuild-instructions-recommended">
<span id="sec-build-superbuild"></span><h3>SUPERBUILD Instructions (recommended)<a class="headerlink" href="#superbuild-instructions-recommended" title="Link to this heading"></a></h3>
<p>By default MFIX-Exa CMake looks for an existing AMReX installation on the system. If none is found, it falls back to <strong>SUPERBUILD</strong> mode.
In this mode, MFIX-Exa CMake inherents AMReX CMake targets and configuration options, that is, MFIX-Exa and AMReX are configured and built as a single entity</p>
<p>Assuming no valid AMReX installation is present on the target system, and <code class="docutils literal notranslate"><span class="pre">AMReX_ROOT</span></code> is not set (see <a class="reference internal" href="#sec-build-standalone"><span class="std std-ref">STANDALONE instructions</span></a>), the following code will build MFIX-Exa in <strong>SUPERBUILD</strong> mode:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>http://mfix.netl.doe.gov/gitlab/exa/mfix.git
&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>mfix
&gt;<span class="w"> </span>mkdir<span class="w"> </span>build
&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build
&gt;<span class="w"> </span>cmake<span class="w"> </span><span class="o">[</span>mfix<span class="w"> </span>options<span class="o">]</span><span class="w"> </span><span class="o">[</span>amrex<span class="w"> </span>options<span class="o">]</span><span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=[</span>Debug<span class="p">|</span>Release<span class="p">|</span>RelWithDebInfo<span class="p">|</span>MinSizeRel<span class="o">]</span><span class="w"> </span>..
&gt;<span class="w"> </span>make<span class="w"> </span>-j
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">[amrex</span> <span class="pre">options]</span></code> in the snippet above is a list of any of the AMReX configuration options listed in
the <a class="reference external" href="https://amrex-codes.github.io/amrex/docs_html/BuildingAMReX.html#building-with-cmake">AMReX user guide</a>,
while <code class="docutils literal notranslate"><span class="pre">[mfix</span> <span class="pre">options]</span></code> is any of the configuration options listed <a class="reference internal" href="#tab-mfixcmakeoptions"><span class="std std-ref">here</span></a>.</p>
<p>For example, to enable AMReX profiling capabilities in MFIX_Exa, configure as follows:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span>cmake<span class="w"> </span><span class="o">[</span>mfix<span class="w"> </span>options<span class="o">]</span><span class="w"> </span>-DAMReX_TINY_PROFILE<span class="o">=</span>yes<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=[</span>Debug<span class="p">|</span>Release<span class="p">|</span>RelWithDebInfo<span class="p">|</span>MinSizeRel<span class="o">]</span><span class="w"> </span>..
</pre></div>
</div>
<section id="working-with-the-amrex-submodule">
<h4>Working with the AMReX submodule<a class="headerlink" href="#working-with-the-amrex-submodule" title="Link to this heading"></a></h4>
<p><strong>SUPERBUILD</strong> mode relies on a git submodule to checkout the AMReX git repository.
If the AMReX submodule is not initialized, <strong>SUPERBUILD</strong> mode will initialize it and checkout
the AMReX commit the submodule is pointing to.
Instead, if the AMReX submodule has already been manually initialized and a custom commit has been checked out,
<strong>SUPERBUILD</strong> mode will use that commit. For MFIX-Exa development or testing, you may need to build with a different
branch or release of AMReX.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">subprojects/amrex</span></code> directory is a Git repo, so use all standard Git
commands. Either <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">subprojects/amrex</span></code> to run Git commands in the <code class="docutils literal notranslate"><span class="pre">amrex</span></code>
directory, or use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">-C</span> <span class="pre">subprojects/amrex</span></code> in the MFIX-Exa repo. For
instance, to build with the <code class="docutils literal notranslate"><span class="pre">my-amrex-branch</span></code> branch of the AMReX repo:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/path/to/mfix
&gt;<span class="w"> </span>git<span class="w"> </span>-C<span class="w"> </span>subprojects/amrex<span class="w"> </span>checkout<span class="w"> </span>my-amrex-branch
&gt;<span class="w"> </span>git<span class="w"> </span>status
...
modified:<span class="w">   </span>subprojects/amrex<span class="w"> </span><span class="o">(</span>new<span class="w"> </span>commits<span class="o">)</span>
</pre></div>
</div>
<p>The branch <code class="docutils literal notranslate"><span class="pre">my-amrex-branch</span></code> will then be used when building MFIX-Exa.</p>
<p>To revert to the default version of the AMReX submodule, run <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">submodule</span>
<span class="pre">update</span></code>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/path/to/mfix
&gt;<span class="w"> </span>git<span class="w"> </span>submodule<span class="w"> </span>update
</pre></div>
</div>
<p>You can edit, commit, pull, and push AMReX changes from <code class="docutils literal notranslate"><span class="pre">subprojects/amrex</span></code>.
AMReX development is outside the scope of this document. Run <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code> in
the top-level MFix-Exa repo to see whether the AMReX submodule has new commits,
modified files, or untracked files.</p>
<p>To update the AMReX submodule referenced by MFIX-Exa:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span>git<span class="w"> </span>-C<span class="w"> </span>subprojects/amrex<span class="w"> </span>checkout<span class="w"> </span>UPDATED_AMREX_COMMIT_SHA1
&gt;<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>subprojects/amrex
&gt;<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;Updating AMReX version&#39;</span>
</pre></div>
</div>
<p>This will only update the AMReX SHA-1 referenced by MFIX-Exa. Uncommitted AMReX
changes and untracked AMReX files under <code class="docutils literal notranslate"><span class="pre">subprojects/amrex</span></code> are not added by
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">subprojects/amrex</span></code>. (To commit to the AMReX repo, change directories
to <code class="docutils literal notranslate"><span class="pre">subprojects/amrex</span></code> and run Git commands there, before <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span>
<span class="pre">subprojects/amrex</span></code>.)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only update the AMReX submodule reference in coordination with the other
MFIX-Exa developers!</p>
</div>
</section>
</section>
<section id="standalone-instructions">
<span id="sec-build-standalone"></span><h3>STANDALONE instructions<a class="headerlink" href="#standalone-instructions" title="Link to this heading"></a></h3>
<section id="building-amrex">
<h4>Building AMReX<a class="headerlink" href="#building-amrex" title="Link to this heading"></a></h4>
<p>Clone AMReX from the official Git repository.
Note that the only branch available is <em>development</em>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/AMReX-Codes/amrex.git
</pre></div>
</div>
<p>Next, configure, build and install AMReX as follows:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>amrex
&gt;<span class="w"> </span>mkdir<span class="w"> </span>build
&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build
&gt;<span class="w"> </span>cmake<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=[</span>Debug<span class="p">|</span>Release<span class="p">|</span>RelWithDebInfo<span class="p">|</span>MinSizeRel<span class="o">]</span><span class="w"> </span>-DAMReX_PARTICLES<span class="o">=</span>yes<span class="w"> </span>-DAMReX_EB<span class="o">=</span>yes<span class="w"> </span>-DAMReX_PLOTFILE_TOOLS<span class="o">=</span>yes<span class="w"> </span><span class="o">[</span>other<span class="w"> </span>amrex<span class="w"> </span>options<span class="o">]</span><span class="w"> </span>-DCMAKE_INSTALL_PREFIX:PATH<span class="o">=</span>/absolute_path_to_amrex_installdir<span class="w"> </span>..
&gt;<span class="w"> </span>make<span class="w"> </span>install
</pre></div>
</div>
<p>The options <strong>AMReX_PARTICLES=yes</strong>, <strong>AMReX_EB=yes</strong> and  <strong>AMReX_PLOTFILE_TOOLS=yes</strong> are required by MFIX-Exa. <code class="docutils literal notranslate"><span class="pre">[other</span> <span class="pre">amrex</span> <span class="pre">options]</span></code> in the snippet above refers to any other AMReX configuration option in addition to the required ones. Please refer to the <a class="reference external" href="https://amrex-codes.github.io/amrex/docs_html/BuildingAMReX.html#building-with-cmake">AMReX user guide</a> for more details on building AMReX with CMake.</p>
</section>
<section id="id2">
<h4>Building MFIX-Exa<a class="headerlink" href="#id2" title="Link to this heading"></a></h4>
<p>Clone and build MFIX-Exa:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>http://mfix.netl.doe.gov/gitlab/exa/mfix.git
&gt;<span class="w"> </span>mkdir<span class="w"> </span>build
&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build
&gt;<span class="w"> </span>cmake<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=[</span>Debug<span class="p">|</span>Release<span class="p">|</span>RelWithDebInfo<span class="p">|</span>MinSizeRel<span class="o">]</span><span class="w"> </span><span class="o">[</span>mfix<span class="w"> </span>options<span class="o">]</span><span class="w"> </span>-DAMReX_ROOT<span class="o">=</span>/absolute/path/to/amrex/installdir<span class="w"> </span>..
&gt;<span class="w"> </span>make<span class="w"> </span>-j
</pre></div>
</div>
<p>Passing <code class="docutils literal notranslate"><span class="pre">-DAMReX_ROOT=/absolute/path/to/amrex/installdir</span></code> instructs CMake to search
<code class="docutils literal notranslate"><span class="pre">/absolute/path/to/amrex/installdir</span></code> before searching system paths
for an available AMReX installation.
<code class="docutils literal notranslate"><span class="pre">AMReX_ROOT</span></code> can also be set as an environmental variable instead of passing it as a command line option.
<code class="docutils literal notranslate"><span class="pre">[mfix</span> <span class="pre">options]</span></code> indicates any of the configuration option listed in the table below.</p>
<span id="tab-mfixcmakeoptions"></span><table class="docutils align-default" id="id3">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">MFIX-Exa configuration options</span><a class="headerlink" href="#id3" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Option name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Possible values</p></th>
<th class="head"><p>Default
value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CMAKE_CXX_FLAGS</p></td>
<td><p>User-defined C++ flags</p></td>
<td><p>valid C++
compiler flags</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p>CMAKE_CUDA_FLAGS</p></td>
<td><p>User-defined CUDA flags</p></td>
<td><p>valid CUDA
compiler flags</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p>MFIX_MPI</p></td>
<td><p>Enable build with MPI</p></td>
<td><p>no/yes</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>MFIX_OMP</p></td>
<td><p>Enable build with OpenMP</p></td>
<td><p>no/yes</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-even"><td><p>MFIX_GPU_
BACKEND</p></td>
<td><p>On-node, accelerated GPU backend</p></td>
<td><p>NONE,SYSCL,CUDA,HIP</p></td>
<td><p>NONE</p></td>
</tr>
<tr class="row-odd"><td><p>MFIX_HYPRE</p></td>
<td><p>Enable HYPRE support</p></td>
<td><p>no/yes</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-even"><td><p>MFIX_FPE</p></td>
<td><p>Build with Floating-Point
Exceptions checks</p></td>
<td><p>no/yes</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-odd"><td><p>MFIX_CSG</p></td>
<td><p>Build with CSG support</p></td>
<td><p>no/yes</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-even"><td><p>MFIX_MPI_
THREAD_MULTIPLE</p></td>
<td><p>Concurrent MPI calls from
multiple threads</p></td>
<td><p>no/yes</p></td>
<td><p>no</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="few-more-notes-on-building-mfix-exa-with-cmake">
<h3>Few more notes on building MFIX-Exa with cmake<a class="headerlink" href="#few-more-notes-on-building-mfix-exa-with-cmake" title="Link to this heading"></a></h3>
<p>The system defaults compilers can be overwritten as follows:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span>cmake<span class="w"> </span>-DCMAKE_CXX_COMPILER<span class="o">=</span>&lt;c++-compiler&gt;<span class="w"> </span><span class="o">[</span>options<span class="o">]</span><span class="w">  </span>..
</pre></div>
</div>
<p>When building on a platform that uses the <code class="docutils literal notranslate"><span class="pre">module</span></code> utility, use either
the above command (with full path to the compilers) or the following:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span>cmake<span class="w"> </span>-DCMAKE_CXX_COMPILER<span class="o">=</span>CC<span class="w"> </span><span class="o">[</span>options<span class="o">]</span><span class="w"> </span>..
</pre></div>
</div>
<p>MFIX-Exa uses the same compiler flags used to build AMReX, unless
<code class="docutils literal notranslate"><span class="pre">CMAKE_CXX_FLAGS</span></code> is explicitly provided, or
the environmental variable <code class="docutils literal notranslate"><span class="pre">CXXFLAGS</span></code> is set.</p>
<p>For GPU builds, MFIX-Exa relies on the <a class="reference external" href="https://amrex-codes.github.io/amrex/docs_html/GPU.html#building-with-cmake">AMReX GPU build infrastructure</a>
. The target architecture to build for can be specified via the AMReX configuration option <code class="docutils literal notranslate"><span class="pre">-DAMReX_CUDA_ARCH=&lt;target-architecture&gt;</span></code>,
or by defining the <em>environmental variable</em> <code class="docutils literal notranslate"><span class="pre">AMREX_CUDA_ARCH</span></code> (all caps). If no GPU architecture is specified,
CMake will try to determine which GPU is supported by the system.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../GettingStarted_Chapter.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="FirstSimulation.html" class="btn btn-neutral float-right" title="First Simulation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2018, MFIX-Exa Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>